<template name="charInput">
  <label>{{label}}</label>
  <!-- TODO: debug, no longer need name attr? -->
  <input type="text" class="form-control" value="{{value}}">
</template>

<template name="charSelectOption">
  <label>{{label}}</label>
  <select name="class" class="form-control" tabindex=2>
    <!-- TODO: debug -->
    {{#each standardized 'classes'}} <option {{selected ../class this}}>{{this}}</option> {{/each}}
  </select>
</template>

<template name="charText">
  <label>{{label}}</label>
  <!-- TODO: debug -->
  <textarea class="form-control" name="equipment" rows="6" style="resize: vertical;" value="{{value}}"></textarea>
</template>

<!-- TODO: debug -->
<template name="charWeapon">
  <div class="weapon">
    <div class="col-sm-4">
      <label>{{this.[0]}} <!-- name --></label>
      <input type="text" class="weapon-input form-control" data-weapon-index="0" value="{{name}}">
    </div>
    <div class="col-sm-3">
      <label>{{this.[1]}} <!-- atkbonus --></label>
      <input type="text" class="weapon-input form-control" data-weapon-index="1" value="{{atkbonus}}">
    </div>
    <div class="col-sm-5">
      <label>{{this.[2]}} <!-- damage --></label>
      <div class="input-group">
        <input type="text" class="weapon-input form-control" data-weapon-index="2" value="{{damage}}">
        <span class="input-group-addon delete-weapon"><i class="fa fa-minus"></i></span>
      </div>
    </div>
  </div>
</template>

<template name="manageCharacterForm">
	<div class="container" style="margin-top: 40px;">
		<div class="row">
			<div class="col-md-12">
				<form class="form-horizontal create-character" role="form">
					<div class="form-group" style="margin-bottom: 60px;">
						<div class="col-sm-12 col-md-6">

							<h5>Overview</h5>
							<div class="row">
								<div class="col-sm-5"> {{> charInput field='name'}} </div>
								<div class="col-sm-4"> {{> charSelectOption field='class'}} </div>
								<div class="col-sm-3"> {{> charSelectOption field='level'}} </div>
							</div>

							<div class="row" style="margin-top: 20px;">
								<div class="col-sm-4"> {{> charSelectOption field='background'}} </div>
                <div class="col-sm-4"> {{> charSelectOption field='race'}} </div>
								<div class="col-sm-4"> {{> charSelectOption field='alignment'}} </div>
							</div>

							<div class="fullwidthline" style="margin: 50px 0 40px;"></div>

							<h5>Physical</h5>
							<div class="row">
								<div class="col-sm-4"> {{> charInput field='ac'}} </div>
								<div class="col-sm-4"> {{> charInput field='initiative'}} </div>
								<div class="col-sm-4"> {{> charInput field='speed'}} </div>
							</div>

							<div class="row" style="margin-top: 20px;">
								<div class="col-sm-4"> {{> charInput field='hitPoints'}} </div>
								<div class="col-sm-4"> {{> charInput field='hitDice'}} </div>
							</div>

							<div class="fullwidthline" style="margin: 40px 0 30px;"></div>

							<h5>Weapons</h5>
							<div class="row">
								{{#each weapons}} {{> charWeapon field='weapons'}} {{/each}}
                <hr class="spacer20">
                <div class="col-md-12">
                  <button class="btn btn-success add-weapon">Add</button>
                </div>
							</div>

							<div class="fullwidthline" style="margin: 40px 0 30px;"></div>

							<h5>Equipment, etc.</h5>
							<div class="row">
								<div class="col-sm-12"> {{> charText field='equipment'}} </div>
							</div>
						</div>

						<hr class="spacer60 visible-sm visible-xs">

						<div class="col-sm-12 col-md-6 general-proficiencies" style="padding-left: 50px;">
							<h5>Skills &amp; Proficiencies</h5>

							<div class="row">
								<div class="col-sm-6">
									<label>Proficiency Bonus</label>
									<input type="text" name="proficiency" class="form-control" tabindex=7 value="{{addMod proficiency}}">
								</div>

								<div class="col-sm-6">
									<label>Passive Perception</label>
									<input type="text" name="passive-percep" class="form-control" tabindex=8 value="{{passivePerception}}">
									<span class="instruction">10 + Perception Modifier.</span>
								</div>
							</div>

							<div class="row" style="margin-top: 25px;">
								<div class="col-sm-12 ability-scores">
									<label>Ability Scores</label>
									<div class="row">
										{{#each standardized 'abilityScores'}}
										<div class="col-md-6">
											<div class="input-group input-group-sm" style="width: 100%;">
												<span class="input-group-addon fixed fat">{{abbrev}}</span>
												<input type="text" data-score-index="{{index}}" class="form-control ability" value="{{getArrayValue ../abilityScores index}}">
				  							<span class="base-modifier input-group-addon fixed thin">{{getArrayValue ../abilityModifiers index}}</span>
											</div>
										</div>
										{{/each}}
									</div>
								</div>
							</div>

							<div class="row" style="margin-top: 25px;">
								<div class="col-sm-12 saving-throws">
									<label>Saving Throws</label>
									<div class="row">
										{{#each standardized 'saveProficiencies'}}
										<div class="col-sm-6 col-md-6">
											<div class="input-group input-group-sm">
												<span class="input-group-addon fixed prof-name">{{name}}</span>
												<span data-score-index="{{index}}" class="input-group-addon fixed">{{isProficient ../abilityModifiers index ../proficiency ../proficiencies name}}</span>
													<span class="input-group-addon fixed thin">
													<input type="checkbox" {{checkProficiency ../proficiencies name}} data-add-proficiency-to="{{name}}" class="save-proficiency">
												</span>
											</div>
										</div>
										{{/each}}
									</div>
								</div>
							</div>

							<div class="row" style="margin-top: 25px;">
								<div class="col-sm-12 general-proficiencies">
									<label>Skill Proficiencies</label>
									<div class="row">
										{{#each standardized 'skillProficiencies'}}
										<div class="col-sm-6 col-md-6">
											<div class="input-group input-group-sm">
												<span class="input-group-addon fixed prof-name">{{name}} ({{attribute}})</span>
												<span data-score-index="{{index}}" class="input-group-addon prof-num fixed {{name}}-prof">{{isProficient ../abilityModifiers index ../proficiency ../proficiencies name}}</span>
												<span class="input-group-addon fixed thin">
													<input type="checkbox" {{checkProficiency ../proficiencies name}} data-add-proficiency-to="{{name}}" class="gen-proficiency">
												</span>
											</div>
										</div>
										{{/each}}
									</div>
								</div>
							</div>

						</div>
					</div>

					<div class="fullwidthline"></div>
					<hr class="spacer30">

					<h5>Features &amp; Traits</h5>

					<div class="form-group" style="margin-top: 0; padding-top; 0;">
						<div id="traits">
							{{#each traits}}
							<!-- TODO: Implement delete button  -->
								<div class="col-sm-6 col-md-4 trait">
									<div class="row">
										<div class="col-sm-12">
											<div class="input-group">
												<span class="input-group-addon"><i class="fa fa-file-o"></i></span>
												<input type="text" class="trait-name form-control" placeholder="Feature Name" value="{{name}}">
                        <span class="input-group-addon delete-trait"><i class="fa fa-minus"></i></span>
											</div>
										</div>
									</div>

									<div class="row" style="margin-top: 20px;">
										<div class="col-sm-12">
											<textarea class="form-control trait-description" rows="5" style="resize: vertical;" placeholder="Description" value="{{description}}"></textarea>
										</div>
									</div>
								</div>
							{{/each}}
						</div>

						<div class="col-sm-4 col-md-2 add-feat-trait">
							<div class="add-box">
								<i class="fa fa-plus fa-2x"></i>
								<span class="add">Add</span>
							</div>
						</div>
					</div>

					<div class="form-group" style="margin-top: 10px;">
						<div class="col-sm-12">
							<button type="submit" class="btn btn-success"><i class="fa fa-thumbs-o-up"></i>&nbsp; Update</button> &nbsp;
							<button class="btn btn-danger delete-character"><i class="fa fa-close"></i>&nbsp; Delete</button>
						</div>
					</div>

					<hr class="spacer60">
				</form>
			</div>
		</div>
	</div>
</template>
