<template name="characters">
	<div id="page-head">
		<div class="container">
			<div class="row">
				<div class="col-md-8">
					<h3>Character Sheets</h3>
				</div>
			</div>
		</div>
	</div>

	<div class="container">
		<div class="row">
			<div class="col-md-8">
				<ul class="group-list">
						<!-- TODO: Rename to userCharacters and add view link -->
				    {{#each characters}}
				      <li><a href="{{pathFor 'editCharacter'}}">{{name}}</a></li>
				    {{/each}}
				</ul>
				<button id="create-character" class="btn btn-primary"><i class="fa fa-plus"></i> Add Character Sheet</button>
			</div>
		</div>
	</div>
</template>

<!-- TODO: Be smarter about reusing code! REFACTOR ASAP! -->
<!-- TODO: combine create & edit templates and reuse code blocks as needed -->
<template name="createCharacter">
	<!-- TODO: Get rid of hr usage throughout the app -->
	<hr class="spacer60">
	<hr class="spacer60">

	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<h2>Character Creation</h2>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12">
				<form class="form-horizontal create-character" role="form">
					<div class="form-group" style="margin-bottom: 60px;">
						<div class="col-sm-12 col-md-6">
							<div class="row">
								<div class="col-sm-12">
									<h5>Overview</h5>
								</div>
							</div>

							<div class="row">
								<div class="col-sm-5">
									<label>Name</label>
									<input type="text" name="charname" class="form-control" placeholder="" tabindex=1>
								</div>

								<div class="col-sm-4">
									<label>Class</label>
									<select name="class" class="form-control" tabindex=2>
										{{#each standardized 'classes'}}
										<option>{{this}}</option>
										{{/each}}
									</select>
								</div>

								<div class="col-sm-3">
									<label>Level</label>
									<input type="text" name="level" class="form-control" placeholder="0" tabindex=3>
								</div>
							</div>

							<div class="row" style="margin-top: 20px;">
								<div class="col-sm-4">
									<label>Background</label>
									<select name="background" class="form-control" tabindex=4>
										{{#each standardized 'backgrounds'}}
										<option>{{this}}</option>
										{{/each}}
									</select>
								</div>

								<div class="col-sm-4">
									<label>Race</label>
									<select name="race" class="form-control" tabindex=5>
										{{#each standardized 'races'}}
										<option>{{this}}</option>
										{{/each}}
									</select>
								</div>

								<div class="col-sm-4">
									<label>Alignment</label>
									<select name="alignment" class="form-control" tabindex=6>
										{{#each standardized 'alignments'}}
										<option>{{this}}</option>
										{{/each}}
									</select>
								</div>
							</div>

							<div class="fullwidthline" style="margin: 50px 0 40px;"></div>

							<div class="row" style="margin-top: 40px;">
								<div class="col-sm-12">
									<h5>Physical</h5>
								</div>

								<div class="col-sm-4">
									<label>Armor Class</label>
									<input type="text" name="ac" class="form-control" placeholder="" tabindex=15>
								</div>

								<div class="col-sm-4">
									<label>Initiative</label>
									<input type="text" name="initiative" class="form-control" placeholder="+0" tabindex=16>
								</div>

								<div class="col-sm-4">
									<label>Speed</label>
									<input type="text" name="speed" class="form-control" placeholder="" tabindex=17>
								</div>
							</div>

							<div class="row" style="margin-top: 20px;">
								<div class="col-sm-4">
									<label>Hit Points</label>
									<input type="text" name="hitpoints" class="form-control" placeholder="" tabindex=18>
								</div>

								<div class="col-sm-4">
									<label>Hit Dice</label>
									<input type="text" name="hitdice" class="form-control" placeholder="" tabindex=19>
								</div>
							</div>

							<div class="fullwidthline" style="margin: 40px 0 30px;"></div>

							<div class="row">
								<div class="col-md-12">
									<h5>Weapons</h5>
								</div>

								<div class="weapon" data-weapon-number="0">
									<div class="col-sm-4">
										<label>Name</label>
										<input type="text" name="weapon-name" class="form-control weapon-input" data-weapon-index="0" placeholder="Battleaxe">
									</div>
									<div class="col-sm-3">
										<label>Atk Bonus</label>
										<input type="text" name="atkbonus" class="form-control weapon-input" data-weapon-index="1" placeholder="+4">
									</div>
									<div class="col-sm-5">
										<label>Damage</label>
										<input type="text" name="weapon-damage" class="form-control weapon-input" data-weapon-index="2" placeholder="1d8 + 4">
									</div>
								</div>

								<hr class="spacer30">

								<div class="weapon" data-weapon-number="1">
									<div class="col-sm-4">
										<label>Name</label>
										<input type="text" name="weapon" class="form-control weapon-input" data-weapon-index="0" placeholder="">
									</div>
									<div class="col-sm-3">
										<label>Atk Bonus</label>
										<input type="text" name="atkbonus" class="form-control weapon-input" data-weapon-index="1" placeholder="">
									</div>
									<div class="col-sm-5">
										<label>Damage</label>
										<input type="text" name="damage" class="form-control weapon-input" data-weapon-index="2" placeholder="">
									</div>
								</div>
							</div>

							<div class="fullwidthline" style="margin: 40px 0 30px;"></div>

							<div class="row">
								<div class="col-md-12">
									<h5>Equipment, etc.</h5>
								</div>
							</div>

							<div class="row">
								<div class="col-sm-12">
									<label for="">Equipment</label>
									<textarea class="form-control" name="equipment" rows="6" style="resize: vertical;"></textarea>
								</div>
							</div>
						</div>

						<hr class="spacer60 visible-sm visible-xs">

						<div class="col-sm-12 col-md-6 general-proficiencies" style="padding-left: 50px;">
							<div class="row">
								<div class="col-sm-12">
									<h5>Skills &amp; Proficiencies</h5>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-6">
									<label for="">Proficiency Bonus</label>
									<input type="text" name="proficiency" class="form-control" tabindex=7>

									<span class="instruction">Enter your proficiency bonus first to ensure all bonuses are calculated correctly.</span>
								</div>
								<div class="col-sm-6">
									<label for="">Passive Perception</label>
									<input type="text" name="passive-percep" class="form-control" value="10" tabindex=8>

									<span class="instruction">Passive perception is calculated by 10 + Perception Modifier.</span>
								</div>
							</div>

							<div class="row" style="margin-top: 25px;">
								<div class="col-sm-12 ability-scores">
									<label for="">Ability Scores</label>
									<div class="row">
										{{#each standardized 'abilityScores'}}
										<div class="col-md-6">
											<div class="input-group input-group-sm" style="width: 100%;">
												<span class="input-group-addon fixed fat">{{abbrev}}</span>
												<input type="text" data-score-index="0" class="form-control ability">
				  								<span class="base-modifier input-group-addon fixed thin"></span>
											</div>
										</div>
										{{/each}}
									</div>
								</div>
							</div>

							<div class="row" style="margin-top: 25px;">
								<div class="col-sm-12 saving-throws">
									<label for="">Saving Throws</label>
									<div class="row">
										{{#each standardized 'saveProficiencies'}}
										<div class="col-sm-6 col-md-6">
											<div class="input-group input-group-sm">
												<span class="input-group-addon fixed prof-name">{{name}}</span>
												<span data-score-index="{{index}}" class="input-group-addon fixed"></span>
													<span class="input-group-addon fixed thin">
													<input type="checkbox" class="save-proficiency">
												</span>
											</div>
										</div>
										{{/each}}
									</div>
								</div>
							</div>

							<div class="row" style="margin-top: 25px;">
								<div class="col-sm-12 general-proficiencies">
									<label for="">Skill Proficiencies</label>
									<div class="row">
										{{#each standardized 'skillProficiencies'}}
										<div class="col-sm-6 col-md-6">
											<div class="input-group input-group-sm">
												<span class="input-group-addon fixed prof-name">{{name}} ({{attribute}})</span>
												<span data-score-index="{{index}}" class="input-group-addon fixed"></span>
													<span class="input-group-addon fixed thin">
													<input type="checkbox" data-add-proficiency-to="{{name}}" class="gen-proficiency">
												</span>
											</div>
										</div>
										{{/each}}
									</div>
								</div>
							</div>
						</div>
					</div>

					<div class="fullwidthline"></div>
					<hr class="spacer30">

					<div class="row" style="margin-bottom: 0; padding-bottom; 0;">
						<div class="col-sm-12" style="margin-bottom: 0; padding-bottom; 0;">
							<h5>Features &amp; Traits</h5>
							<input type="hidden" name="count" value="1" />
						</div>
					</div>

					<div class="form-group"  style="margin-top: 0; padding-top; 0;">
						<div id="traits">
							<div class="col-sm-6 col-md-4 trait" data-trait-count="1" id="charTrait">
								<div class="row">
									<div class="col-sm-12">
										<div class="input-group">
											<span class="input-group-addon"><i class="fa fa-file-o"></i></span>
											<input type="text" class="trait-name form-control" data-trait-index="0" placeholder="Trait/Feature Name">
										</div>
									</div>
								</div>
								<hr class="spacer20">
								<div class="row">
									<div class="col-sm-12">
										<textarea class="form-control trait-description" rows="5" style="resize: vertical;" data-trait-index="1" placeholder="Description"></textarea>
									</div>
								</div>
							</div>
						</div>

						<div class="col-sm-4 col-md-2 add-feat-trait">
							<div class="add-box">
								<i class="fa fa-plus fa-2x"></i>
								<span class="add">Add</span>
							</div>
						</div>
					</div>

					<hr class="spacer30">

					<div class="form-group">
						<div class="col-sm-12">
							<button type="submit" class="btn btn-primary">Create Character</button>
						</div>
					</div>
				</form>
			</div>
		</div>
	</div>
</template>

<!-- TODO: fix tab indexes -->
<template name="editCharacter">
	<hr class="spacer60">
	<hr class="spacer60">

	<div class="container">
		<div class="row">
			<div class="col-md-12">
				<h2>Edit Character</h2>
			</div>
		</div>

		<div class="row">
			<div class="col-md-12">
				<form class="form-horizontal create-character" role="form">
					<div class="form-group" style="margin-bottom: 60px;">
						<div class="col-sm-12 col-md-6">
							<div class="row">
								<div class="col-sm-12">
									<h5>Overview</h5>
								</div>
							</div>

							<div class="row">
								<div class="col-sm-5">
									<label>Name</label>
									<input type="text" name="charname" class="form-control" value="{{name}}" tabindex=1>
								</div>

								<div class="col-sm-4">
									<label>Class</label>
									<select name="class" class="form-control" tabindex=2>
										{{#each standardized 'classes'}}
										<option {{selected ../class this}}>{{this}}</option>
										{{/each}}
									</select>
								</div>

								<div class="col-sm-3">
									<label>Level</label>
									<input type="text" name="level" class="form-control" placeholder="0" tabindex=3 value="{{level}}">
								</div>
							</div>

							<div class="row" style="margin-top: 20px;">
								<div class="col-sm-4">
									<label>Background</label>
									<select name="background" class="form-control" tabindex=4>
										{{#each standardized 'backgrounds'}}
										<option {{selected ../background this}}>{{this}}</option>
										{{/each}}
									</select>
								</div>

								<div class="col-sm-4">
									<label>Race</label>
									<select name="race" class="form-control" tabindex=5>
										{{#each standardized 'races'}}
										<option {{selected ../race this}}>{{this}}</option>
										{{/each}}
									</select>
								</div>

								<div class="col-sm-4">
									<label>Alignment</label>
									<select name="alignment" class="form-control" tabindex=6>
										{{#each standardized 'alignments'}}
										<option {{selected ../alignment this}}>{{this}}</option>
										{{/each}}
									</select>
								</div>
							</div>

							<div class="fullwidthline" style="margin: 50px 0 40px;"></div>

							<div class="row" style="margin-top: 40px;">
								<div class="col-sm-12">
									<h5>Physical</h5>
								</div>

								<div class="col-sm-4">
									<label>Armor Class</label>
									<input type="text" name="ac" class="form-control" placeholder="" tabindex=15 value="{{ac}}">
								</div>

								<div class="col-sm-4">
									<label>Initiative</label>
									<input type="text" name="initiative" class="form-control" placeholder="+0" tabindex=16 value="{{initiative}}">
								</div>

								<div class="col-sm-4">
									<label>Speed</label>
									<input type="text" name="speed" class="form-control" tabindex=17 value="{{speed}}">
								</div>
							</div>

							<div class="row" style="margin-top: 20px;">
								<div class="col-sm-4">
									<label>Hit Points</label>
									<input type="text" name="hitpoints" class="form-control" tabindex=18 value="{{hitPoints}}">
								</div>

								<div class="col-sm-4">
									<label>Hit Dice</label>
									<input type="text" name="hitdice" class="form-control" tabindex=19 value="{{hitDice}}">
								</div>
							</div>

							<div class="fullwidthline" style="margin: 40px 0 30px;"></div>

							<div class="row">
								<div class="col-md-12">
									<h5>Weapons</h5>
								</div>

								<!-- TODO: Refactor with spacebars' smart attributes, or at very least clean up hacky index stuff -->
								<!-- TODO: Implement add / delete buttons  -->
								{{#each weapons}}
								<div class="weapon" data-weapon-number="0">
									<div class="col-sm-4">
										<label>Name</label>
										<input type="text" name="weapon-name" class="form-control weapon-input" data-weapon-index="0" value="{{name}}">
									</div>
									<div class="col-sm-3">
										<label>Atk Bonus</label>
										<input type="text" name="atkbonus" class="form-control weapon-input" data-weapon-index="1" value="{{atkbonus}}">
									</div>
									<div class="col-sm-5">
										<label>Damage</label>
										<input type="text" name="weapon-damage" class="form-control weapon-input" data-weapon-index="2" value="{{damage}}">
									</div>
								</div>
								<hr class="spacer30">
								{{/each}}
							</div>

							<div class="fullwidthline" style="margin: 40px 0 30px;"></div>

							<div class="row">
								<div class="col-md-12">
									<h5>Equipment, etc.</h5>
								</div>
							</div>

							<div class="row">
								<div class="col-sm-12">
									<label for="">Equipment</label>
									<textarea class="form-control" name="equipment" rows="6" style="resize: vertical;" value="{{equipment}}"></textarea>
								</div>
							</div>
						</div>

						<hr class="spacer60 visible-sm visible-xs">

						<div class="col-sm-12 col-md-6 general-proficiencies" style="padding-left: 50px;">
							<div class="row">
								<div class="col-sm-12">
									<h5>Skills &amp; Proficiencies</h5>
								</div>
							</div>
							<div class="row">
								<div class="col-sm-6">
									<label for="">Proficiency Bonus</label>
									<input type="text" name="proficiency" class="form-control" tabindex=7 value="{{proficiency}}">

									<span class="instruction">Enter your proficiency bonus first to ensure all bonuses are calculated correctly.</span>
								</div>
								<div class="col-sm-6">
									<label for="">Passive Perception</label>
									<input type="text" name="passive-percep" class="form-control" tabindex=8 value="{{passivePerception}}">
									<span class="instruction">Passive perception is calculated by 10 + Perception Modifier.</span>
								</div>
							</div>

							<div class="row" style="margin-top: 25px;">
								<div class="col-sm-12 ability-scores">
									<label for="">Ability Scores</label>
									<div class="row">
										{{#each standardized 'abilityScores'}}
										<div class="col-md-6">
											<div class="input-group input-group-sm" style="width: 100%;">
												<span class="input-group-addon fixed fat">{{abbrev}}</span>
												<input type="text" data-score-index="0" class="form-control ability" value="{{getArrayValue ../abilityScores index}}">
				  								<span class="base-modifier input-group-addon fixed thin">{{getArrayValue ../abilityModifiers index}}</span>
											</div>
										</div>
										{{/each}}
									</div>
								</div>
							</div>

							<div class="row" style="margin-top: 25px;">
								<div class="col-sm-12 saving-throws">
									<label for="">Saving Throws</label>
									<div class="row">
										{{#each standardized 'saveProficiencies'}}
										<div class="col-sm-6 col-md-6">
											<div class="input-group input-group-sm">
												<span class="input-group-addon fixed prof-name">{{name}}</span>
												<span data-score-index="{{index}}" class="input-group-addon fixed">{{isProficient ../abilityModifiers index ../proficiency ../proficiencies name}}</span>
													<span class="input-group-addon fixed thin">
													<input type="checkbox" {{checkProficiency ../proficiencies name}} data-add-proficiency-to="{{name}}" class="save-proficiency">
												</span>
											</div>
										</div>
										{{/each}}
									</div>
								</div>
							</div>

							<div class="row" style="margin-top: 25px;">
								<div class="col-sm-12 general-proficiencies">
									<label for="">Skill Proficiencies</label>
									<div class="row">
										{{#each standardized 'skillProficiencies'}}
										<div class="col-sm-6 col-md-6">
											<div class="input-group input-group-sm">
												<span class="input-group-addon fixed prof-name">{{name}} ({{attribute}})</span>
												<span data-score-index="{{index}}" class="input-group-addon fixed">{{isProficient ../abilityModifiers index ../proficiency ../proficiencies name}}</span>
													<span class="input-group-addon fixed thin">
													<input type="checkbox" {{checkProficiency ../proficiencies name}} data-add-proficiency-to="{{name}}" class="gen-proficiency">
												</span>
											</div>
										</div>
										{{/each}}
									</div>
								</div>
							</div>

						</div>
					</div>

					<div class="fullwidthline"></div>
					<hr class="spacer30">

					<div class="row" style="margin-bottom: 0; padding-bottom; 0;">
						<div class="col-sm-12" style="margin-bottom: 0; padding-bottom; 0;">
							<h5>Features &amp; Traits</h5>
							<input type="hidden" name="count" value="1" />
						</div>
					</div>

					<div class="form-group" style="margin-top: 0; padding-top; 0;">
						<div id="traits">
							{{#each traits}}
							<!-- TODO: Implement delete button  -->
								<div class="col-sm-6 col-md-4 trait" data-trait-count="" id="charTrait">
									<div class="row">
										<div class="col-sm-12">
											<div class="input-group">
												<span class="input-group-addon"><i class="fa fa-file-o"></i></span>
												<input type="text" class="trait-name form-control" data-trait-index="0" value="{{name}}">
											</div>
										</div>
									</div>

									<hr class="spacer20">

									<div class="row">
										<div class="col-sm-12">
											<textarea class="form-control trait-description" rows="5" style="resize: vertical;" data-trait-index="1" value="{{description}}"></textarea>
										</div>
									</div>
								</div>
							{{/each}}
						</div>

						<div class="col-sm-4 col-md-2 add-feat-trait">
							<div class="add-box">
								<i class="fa fa-plus fa-2x"></i>
								<span class="add">Add</span>
							</div>
						</div>
					</div>

					<hr class="spacer10">

					<div class="form-group">
						<div class="col-sm-12">
							<button type="submit" class="btn btn-success"><i class="fa fa-thumbs-o-up"></i>&nbsp; Update</button> &nbsp;
							<button class="btn btn-danger delete-character"><i class="fa fa-close"></i>&nbsp; Delete</button>
						</div>
					</div>

					<hr class="spacer50">
				</form>
			</div>
		</div>
	</div>
</template>
